<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>TlachialianiCode</title>
        <link rel="icon" type="image/png" sizes="32x32" href="img/logo-rb.png" />
        <!-- Custom CSS -->
        <link rel="stylesheet" href="./css/main.css">
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/0d40d8f017.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <main>
            <section id="sectionHome">
                <article>
                    <header>
                        <h1>TlachiCode<img class="small-logo" src="img/logo-rb.png" alt="foo"></h1>
                        <p>Bienvenido a TlachiCode, el equipo agradece tu voto de confianza para ayudarte 
                            a desarrollar tu idea, nuestra prioridad será entregarte un producto 
                            profesional que se ajuste a tu negocio y a tu forma de trabajar</p>
                    </header>
                </article>
                <article class="card-feature">
                    <div>
                        &nbsp;<i class="float-md-left fas fa-cloud"></i>
                        <span>&nbsp; Aplicación Web</span>
                        <div class="feature-info">
                            <span>Aplicaciones para celular y computadora que usan el navegador.
                            </span>
                        </div>
                    </div>
                    <div>
                        <i class="float-md-left fas fa-mobile-alt"></i>
                        <span>&nbsp; Aplicación Movil</span>
                        <div class="feature-info">
                            <span>Aplicaciones para el celular que no usan el navegador.</span>
                        </div>
                    </div>
                    <div>
                        <i class="float-md-left fas fa-desktop"></i>
                        <span>&nbsp; Aplicación de Escritorio</span>
                        <div class="feature-info">
                            <span>Aplicaciones para la computadora que no usan el navegador.</span>
                        </div>
                    </div>
                </article>
            </section>
            <section id="sectionProyects" style="display:none;">
                <h2>Proyectos</h2>
                <div class="carousel">
                    <i id="carouselPrevius" class="fas fa-angle-double-left"></i>
                    <article class="carousel-active">
                        <img src="" alt="foo">
                        <div class="carousel-info">
                            <h3>foo text</h3>
                            <p>foo text.</p>
                        </div>
                    </article>
                    <article>
                        <img src="" alt="foo">
                        <div class="carousel-info">
                            <h3>foo text</h3>
                            <p>foo text.</p>
                        </div>
                    </article>
                    <article>
                        <img src="" alt="foo">
                        <div class="carousel-info">
                            <h3>foo text</h3>
                            <p>foo text.</p>
                        </div>
                    </article>
                    <i id="carouselNext" class="fas fa-angle-double-right"></i>
                </div>
            </section>
            <section id="sectionWhy">
                <h2>¿Por que nosostros?</h2>
                <div class="card-wrapper">
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="far fa-star fa-2x"></i>
                            <h3>&nbsp;Rendimiento</h3>
                        </div>
                        <p>Tu página estará lista en no más de dos semanas, 
                            por lo que no tendrás que esperar tiempos absurdos de espera para ver 
                            resultados tangibles.</p>
                    </article>
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="far fa-star fa-2x"></i>
                            <h3>&nbsp;Profesional</h3>
                        </div>
                        <p>Nos tomamos en serio la ética profesional para 
                            que ningún cliente sienta desconfianza alguna y no se produzcan malos tratos 
                            en la comunicación con el equipo, ten por seguro que nuestras decisiones se rigen 
                            por un estricto codigo etico.</p>
                    </article>
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="far fa-star fa-2x"></i>
                            <h3>&nbsp;Comodidad</h3>
                        </div>
                        <p>Nosotros te ayudaremos a completar tus ideas 
                            y te guiaremos por todo el camino hasta la meta, al final tu visión será completamente 
                            funcional para día a día.</p>
                    </article>
                </div>
            </section>
            <section id="sectionTeam">
                <h2>Equipo de trabajo</h2>
                <div class="card-wrapper">
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="fas fa-user-circle fa-2x"></i>
                            <h3>&nbsp;Josue</h3>
                        </div>
                        <p>"Nos comprometemos para ayudarte a que tengas un software de calidad, 
                            manejar un diseño intuitivo y gran experiencia de usuario, garantizamos 
                            una gran satisfacción."</p>
                    </article>
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="fas fa-user-circle fa-2x"></i>
                            <h3>&nbsp;Hilarión</h3>
                        </div>
                        <p>"Bienvenido a la familia, nos encargaremos de guiarte a tus metas por el 
                            buen camino, estaremos siempre en comunicacion y al tanto de tus necesidades."</p>
                    </article>
                    <article class="card-generic">
                        <div class="card-title">
                            <i class="fas fa-user-circle fa-2x"></i>
                            <h3>&nbsp;Roberto</h3>
                        </div>
                        <p>"De entrada, en nombre del equipo quiero agradecerte tu voto de confianza 
                            para ayudarte a desarrollar tu idea, nuestra prioridad será entregarte un 
                            producto profesional que se ajuste a tu negocio y a tu forma de trabajar."</p>
                    </article>
                </div>
            </section>
            <footer id="sectionContact">
                <div>
                    <i id="icon_facebook" class="fab fa-facebook-f px-2"></i>
                    <i id="icon_whatsapp" class="fab fa-whatsapp px-2"></i>
                </div>
                <h3>Contactanos</h3>
                <img class="medium-logo" src="img/logo-rb.png" alt="foo">
            </footer>
            
            <div class="hidden" id="toUpButton"><i class="fas fa-chevron-up fa-2x"></i></div>
            <div id="indexButton">
                <i class="fas fa-th-list fa-2x"></i>
            </div>
            <nav id="navMenu">
                <i id="closeNavMenuButton" class="fas fa-times"></i>
                <h2 data-navMenuTab="sectionHome">Bienvenido</h2>
                <!--<h2 data-navMenuTab="sectionProyects">Proyectos</h2>-->
                <h2 data-navMenuTab="sectionWhy">¿Por que nosotros?</h2>
                <h2 data-navMenuTab="sectionTeam">Equipo de trabajo</h2>
                <h2 data-navMenuTab="sectionContact">Contacto</h2>
            </nav>
            <div id="loadingScreen">
                <img src="img/logo-rb.png" alt="logo">
                <i class="fas fa-cog fa-spin"></i>
            </div>
        </main>
        <script>
            (function() {
                /* Mientras la pagina no se este cargando mostramos una pantalla de carga.
                 * El delay es para que la pantalla de carga no dure tan poco tiempo.
                 */
                window.onload = function () {
                    window.setTimeout(() => {
                        //Movemos a la izquierda la pantalla de carga.
                        document.querySelector("#loadingScreen").style.left = "-100vw";

                        //algunas animaciones
                        document.querySelector("#sectionHome > article > header > h1")
                            .classList.add("to-up-fade-animation");
                        document.querySelector("#sectionHome > article > header > p")
                            .classList.add("to-up-fade-animation");
                        document.querySelector(".card-feature > div:nth-child(1)")
                            .classList.add("to-left-fade-animation-1");
                        document.querySelector(".card-feature > div:nth-child(2)")
                            .classList.add("to-left-fade-animation-2");
                        document.querySelector(".card-feature > div:nth-child(3)")
                            .classList.add("to-left-fade-animation-3");

                        window.setTimeout(() => {
                            /* Tenemos que cambiar el display de la pantalla de carga para que los
                             * eventos del mouse como hover, active hagan efecto pues realmente la 
                             * pantalla de carga sigue encima de todo, el delay de 1500 es porque la transicion 
                             * de la pantalla de carga tarda 500 en quitarce y los otros 1000 es porque es el tiempo 
                             * minimo que dura la pantalla en mostrarse.
                             */
                            document.querySelector("#loadingScreen").style.display= "none";
                        }, 1500);

                        //Petición para llevar un registro de las visitas
                        fetch("https://chilaquilesenterprise.com/foo/foo.php", {
                            mode: 'no-cors'
                        })
                        .then(res => res.json())
                        .catch(err => 1+2);
                    }, 1000);
                };

                //Escroleamos hasta arriba.
                const scrollToTop = function () {
                    window.scroll({
                        top: 0
                    });
                }

                //Algunas animaciones.
                document.querySelectorAll(".card-generic, section > h2, footer").forEach(e => {
                    e.classList.add("waiting-for-animation");
                });
                
                let elements;
                let windowHeight;
                let hideIndexButton;
                let hideToUpButton;
                let toUpButton = document.querySelector("#toUpButton");
                let indexButton = document.querySelector("#indexButton");

                function init() {
                    hiddenElements = document.querySelectorAll(".waiting-for-animation");
                    windowHeight = window.innerHeight;
                }

                function checkPositionAndEvents() {
                    /* Mientras se esta escroleando el indice se mostrara pero si 
                     * no se escrolea por 2 segundos se ocultara.
                     */
                    clearInterval(hideIndexButton);
                    hideIndexButton = window.setTimeout(() => {
                        indexButton.classList.add("hidden");
                    }, 2000);
                    indexButton.classList.remove("hidden");

                    /* Mostramos el boton para subir hasta arriba si se ha bajado 
                     * lo suficiente.
                     */
                    if (window.scrollY > 300) {
                        clearInterval(hideToUpButton);
                        hideToUpButton = window.setTimeout(() => {
                            toUpButton.classList.add("hidden");
                        }, 2000);
                        toUpButton.classList.remove("hidden");
                    } else {
                        toUpButton.classList.add("hidden");
                    }

                    /* Recorremos todos los elementos que tienen la clase .waiting-for-animation 
                     * y checamos cuando estamos a punto de mostrarlos en la pantalla 
                     * tomando la posicion actual del scroll y la posicion de los elementos 
                     * en el scroll, entonces les quitamos .waiting-for-animation para que su animacion 
                     * se muestre.
                     */
                    for (let i = 0; i < hiddenElements.length; i++) {
                        let element = hiddenElements[i];
                        let positionFromTop = hiddenElements[i].getBoundingClientRect().top;
                        if (positionFromTop - windowHeight <= 0) {
                            element.classList.add("to-up-fade-animation");
                            element.classList.remove("waiting-for-animation");
                        }
                    }
                }

                window.addEventListener('scroll', checkPositionAndEvents);
                window.addEventListener('resize', init);

                init();
                checkPositionAndEvents();

                function Carousel () {
                    this.images = document.querySelectorAll(".carousel > article");
                    this.currentIndex = null;
                    this.autoSlide = null;
                    this.autoSlideDelay = 7000;
                    //Obtenemos el indice de la imagen activa, si es que existe.
                    for (let i = 0; i < this.images.length; i++) {
                        if (this.images[i].classList.contains("carousel-active")) {
                            currentIndex = i;
                        }
                    }
                    //Si no se señalo una imagen activa tomamos la primera.
                    if (this.currentIndex == null) {
                        this.currentIndex = 0;
                        this.images[0].classList.add("carousel-active");
                    }
                    this.clearAnimations = function (image) {
                        image.classList.remove("slice-previus-animation");
                        image.classList.remove("slice-next-animation");
                    }
                    this.update = function () {
                        //Se corrige el rango cuando se sale del limite.
                        if (this.currentIndex < 0) {
                            this.currentIndex = this.images.length-1;
                        } else if (this.currentIndex > this.images.length-1) {
                            this.currentIndex = 0;
                        }
                        //se actualiza la clase de la nueva y antigua imagen activa.
                        let oldImage = document.querySelector(".carousel-active");
                        let newImage = this.images[this.currentIndex];
                        this.clearAnimations(newImage);
                        oldImage.classList.remove("carousel-active");
                        newImage.classList.add("carousel-active");

                        //Reiniciamos el autoSlide cuando se interactua con el carousel.
                        clearInterval(this.autoSlide);
                        this.autoSlide = window.setInterval(() => {
                            this.next();
                        }, this.autoSlideDelay);
                    }
                    this.previus = function () {
                        this.currentIndex -= 1;
                        this.update();
                        this.images[this.currentIndex].classList.add("slice-previus-animation");
                    }
                    this.next = function () {
                        this.currentIndex += 1;
                        this.update();
                        this.images[this.currentIndex].classList.add("slice-next-animation");
                    }
                    document.querySelector("#carouselPrevius").addEventListener("click", e => {
                        this.previus();
                    });
                    document.querySelector("#carouselNext").addEventListener("click", e => {
                        this.next();
                    });

                    //Iniciamos el autoSlide para que avance el carousel.
                    this.autoSlide = window.setInterval(() => {
                        this.previus();
                    }, this.autoSlideDelay);
                }
                function NavMenu () {
                    this.showButton = document.querySelector("#closeNavMenuButton");
                    this.state = false;
                    this.items = document.querySelectorAll("#navMenu > h2");
                    this.currentItem = null;
                    this.lastCurrentItem = null;
                    this.selectItemClass = "nav-menu-keyboard-focus";

                    this.show = function () {
                        this.state = true;
                        document.querySelector("#navMenu").style.top = "0";
                    }
                    this.hide = function () {
                        this.reset();
                        this.state = false;
                        document.querySelector("#navMenu").style.top = "100vh";
                    }
                    this.updateItems = function () {
                        if (this.currentItem < 0) {
                            this.currentItem = this.items.length-1;
                        } else if (this.currentItem > this.items.length-1) {
                            this.currentItem = 0;
                        }
                        this.items[this.currentItem].classList.add(this.selectItemClass);
                        if (this.lastCurrentItem != null) {
                            this.items[this.lastCurrentItem].classList.remove(this.selectItemClass);
                        }
                    }
                    this.reset = function () {
                        if (this.currentItem == null) return;
                        this.items[this.currentItem].classList.remove(this.selectItemClass);
                        this.currentItem = null;
                        this.lastCurrentItem = null;
                    }

                    //Onclick events para los botones del menu de navegacion.
                    window.addEventListener("click", e => {
                        if (e.target.hasAttribute("data-navMenuTab")) {
                            const attValue = e.target.getAttribute("data-navMenuTab");
                            this.state = false;
                            document.querySelector("#navMenu").style.top = "100vh";
                            /* Aqui en lugar de escrolear a la primera seccion lo hacemos hasta 
                            * lo mas arriba posible para que no queden espacios arriba.
                            */
                            if (attValue == "sectionHome") {
                                scrollToTop();
                                return;
                            }
                            document.querySelector(`#${attValue}`).scrollIntoView();
                        }
                    });
                    window.addEventListener("keydown", e => {
                        if (e.which == 27) {
                            let body = document.querySelector("body");
                            if (!this.state) this.show();
                            else this.hide();
                        } else if (this.state) {
                            if (e.which == 38 || e.which == 40) {
                                window.event.preventDefault();
                                this.lastCurrentItem = this.currentItem;
                                if (this.currentItem == null) {
                                    this.currentItem = 0;
                                } else if (e.which == 38) {
                                    this.currentItem -= 1;
                                } else if (e.which == 40) {
                                    this.currentItem += 1;
                                }
                                this.updateItems();
                            } else if (e.which == 13) {
                                this.items[this.currentItem].click();
                                this.reset();
                            }
                        }
                    }, true);

                    toUpButton.addEventListener("click", e => {
                        scrollTotop();
                    });

                    //Eventos globales de las teclas.
                    window.onkeyup = function (e) {
                        if (e.which == 87) {
                            scrollToTop();
                        }
                    }

                    //Eventos de click para el indice y el boton de cerrar menu.
                    indexButton.addEventListener("click", e => {
                        navMenu.show();
                    });
                    closeNavMenuButton.addEventListener("click", e => {
                        navMenu.hide();
                    });
                }

                const carousel = new Carousel();
                const navMenu = new NavMenu();

                document.querySelector("#icon_facebook").addEventListener("click", e => {
                    window.open("https://www.facebook.com/TlachialianiCode-105811988227146");
                });
                document.querySelector("#icon_whatsapp").addEventListener("click", e => {
                    window.open("https://api.whatsapp.com/send?phone=5213141002572");
                });
            })();
        </script>
    </body>
</html>